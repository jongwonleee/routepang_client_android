image: switaewon/android-build
stages:
  - build
  - test
build:
    artifacts:
        expire_in: 4 hours
        paths:
            - app/build/outputs/
            - .android/
    stage: build
    script:
        - pwd
        - "cp app/mock-google-services.json app/google-services.json"
        - ./gradlew assembleDebug
        # - ./gradlew build
        # - ./gradlew test

    tags:
        - android

test:
    stage: test
    
    before_script:
        - "cp app/mock-google-services.json app/google-services.json"
  #     - export ANDROID_HOME=$PWD/.android
   #     - export PATH=$PATH:$PWD/.android/platform-tools/
    
    script:
        - ./gradlew -Pci --console=plain :app:testDebug
        - ./gradlew build
        - ./gradlew test
    
    tags:
        - android
